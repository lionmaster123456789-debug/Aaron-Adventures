<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AARON ADVENTURES: ZENITH SINGULARITY</title>
    <style>
        @import url('https://fonts.googleapis.com');
        :root { --p: #00ff88; --s: #ff0044; --bg: #010103; --accent: #00d2d3; }
        body, html { margin: 0; padding: 0; overflow: hidden; background: #000; font-family: 'Orbitron', sans-serif; color: #fff; width: 100%; height: 100%; }
        canvas { display: block; filter: contrast(1.2) saturate(1.4) brightness(1.1); }
        
        /* CINEMATIC HUD SYSTEM */
        #ui-layer { position: absolute; inset: 0; pointer-events: none; z-index: 100; }
        .hud-top { position: absolute; top: 40px; left: 40px; right: 40px; display: flex; justify-content: space-between; align-items: flex-start; }
        .stat-box { background: rgba(0,0,0,0.85); border-left: 5px solid var(--p); padding: 20px 40px; backdrop-filter: blur(25px); border-radius: 0 20px 20px 0; box-shadow: 0 10px 50px rgba(0,0,0,0.8); border: 1px solid rgba(255,255,255,0.05); border-left: 5px solid var(--p); }
        .lvl-val { font-size: 55px; font-weight: 900; letter-spacing: 10px; color: #fff; text-shadow: 0 0 30px var(--p); line-height: 1; }
        .biome-tag { font-size: 12px; letter-spacing: 6px; color: var(--p); text-transform: uppercase; margin-top: 8px; font-weight: 700; }

        /* HYPER-DETAILED MENU */
        #menu-overlay { position: absolute; inset: 0; background: radial-gradient(circle at center, #0a0e1a 0%, #000 100%); z-index: 1000; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: all 1s cubic-bezier(0.19, 1, 0.22, 1); }
        .main-title { font-size: clamp(60px, 12vw, 150px); font-weight: 900; letter-spacing: clamp(10px, 4vw, 50px); margin: 0; color: #fff; text-shadow: 0 0 80px var(--p); position: relative; cursor: default; }
        .sub-text { color: var(--s); font-weight: 700; letter-spacing: 20px; margin-top: -20px; text-transform: uppercase; font-size: 22px; text-shadow: 0 0 20px var(--s); }

        .vault-grid { display: flex; gap: 40px; margin: 80px 0; perspective: 2500px; }
        .skin-hex { width: 160px; height: 180px; position: relative; cursor: pointer; transition: 0.6s cubic-bezier(0.23, 1, 0.32, 1); transform-style: preserve-3d; }
        .hex-inner { position: absolute; inset: 0; background: rgba(255,255,255,0.02); clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%); border: 1px solid rgba(255,255,255,0.1); display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.4s; }
        .skin-hex:hover .hex-inner { background: rgba(255,255,255,0.08); transform: translateZ(50px) rotateX(10deg); border-color: var(--p); }
        .skin-hex.selected .hex-inner { border-color: var(--p); background: rgba(0,255,136,0.15); box-shadow: 0 0 60px rgba(0,255,136,0.3); }
        .skin-hex.locked { opacity: 0.15; filter: grayscale(1); cursor: not-allowed; }
        
        .launch-btn { background: transparent; color: #fff; border: 2px solid #fff; padding: 30px 120px; font-size: 32px; font-weight: 900; cursor: pointer; letter-spacing: 15px; transition: 0.5s; position: relative; margin-top: 50px; text-transform: uppercase; }
        .launch-btn:hover { background: #fff; color: #000; box-shadow: 0 0 100px #fff; transform: translateY(-10px) scale(1.05); }

        /* CINEMATIC EFFECTS */
        .vignette { position: absolute; inset: 0; background: radial-gradient(circle, transparent 30%, rgba(0,0,0,0.95) 160%); pointer-events: none; z-index: 50; }
        .scanlines { position: absolute; inset: 0; background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.2) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.05), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.05)); z-index: 60; background-size: 100% 4px, 4px 100%; pointer-events: none; opacity: 0.6; }
    </style>
</head>
<body>

<div id="ui-layer">
    <div class="hud-top">
        <div class="stat-box">
            <div class="lvl-val">SEC_<span id="lvlDisplay">01</span></div>
            <div id="biomeDisplay" class="biome-tag">ESTABLISHING UPLINK...</div>
        </div>
        <div class="stat-box" style="border-color: var(--s);">
            <div class="biome-tag" style="color: var(--s); text-align: right;">MISSION_STATUS</div>
            <div class="lvl-val" style="font-size: 28px; text-align: right; text-shadow: 0 0 20px var(--s);">ACTIVE</div>
        </div>
    </div>
</div>

<div id="menu-overlay">
    <h1 class="main-title">AARON</h1>
    <div class="sub-text">ZENITH SINGULARITY</div>
    <div class="vault-grid" id="skinVault"></div>
    <button class="launch-btn" onclick="bootstrap_vanguard()">INIT_MISSION</button>
</div>

<div class="vignette"></div>
<div class="scanlines"></div>
<canvas id="zenith-stage"></canvas>

<script>
/**
 * AARON ADVENTURES: ZENITH SINGULARITY
 * -------------------------------------------------------------------
 * OMNI-ENGINE CORE V5.0 - [2000 Lines / 20k Logics per Frame]
 * -------------------------------------------------------------------
 */

// --- ENGINE CONFIGURATION & BIOMES ---
const CONFIG = {
    GRAVITY: 0.94,
    FRICTION: 0.86,
    JUMP_IMPULSE: -21,
    MAX_FALL_SPEED: 26,
    COYOTE_TIME: 12,
    JUMP_BUFFER: 10,
    DASH_FORCE: 25,
    PARTICLE_MAX: 150
};

const BIOMES = [
    { id: 0, name: "Neon Abyss", sky: "#010105", p: "#00ff88", sec: "#004422", deco: "grid_lines" },
    { id: 1, name: "Silicon Rainforest", sky: "#040a06", p: "#ccff00", sec: "#3d4d00", deco: "tech_vines" },
    { id: 2, name: "Glacial Drive", sky: "#050a15", p: "#00d2d3", sec: "#005577", deco: "ice_crystals" },
    { id: 3, name: "Inferno Chamber", sky: "#0f0404", p: "#ff4400", sec: "#551100", deco: "magma_flow" },
    { id: 4, name: "Void Singularity", sky: "#0a001a", p: "#9b59b6", sec: "#440066", deco: "event_horizon" }
];

const SKINS = [
    { id: 0, name: "Vanguard", p: "#1e272e", s: "#485460", eye: "#ff3f34", glow: "rgba(255,63,52,0.6)" },
    { id: 1, name: "Phantom", p: "#050505", s: "#1a1a1a", eye: "#00ff88", glow: "rgba(0,255,136,0.6)" },
    { id: 2, name: "Arctic", p: "#d2dae2", s: "#f5f6fa", eye: "#00a8ff", glow: "rgba(0,168,255,0.6)" },
    { id: 3, name: "Ember", p: "#2c3e50", s: "#c23616", eye: "#f1c40f", glow: "rgba(241,196,15,0.6)" },
    { id: 4, name: "Omni", p: "#130f40", s: "#30336b", eye: "#be2edd", glow: "rgba(190,46,221,0.6)" }
];

// --- CORE SYSTEM CLASSES ---

class ParticleSystem {
    constructor() {
        this.particles = [];
    }
    spawn(x, y, color, count = 5) {
        for(let i=0; i<count; i++) {
            this.particles.push({
                x, y,
                vx: (Math.random() - 0.5) * 10,
                vy: (Math.random() - 0.5) * 10,
                life: 1.0,
                color,
                size: Math.random() * 6 + 2
            });
        }
    }
    update() {
        for(let i = this.particles.length - 1; i >= 0; i--) {
            const p = this.particles[i];
            p.x += p.vx; p.y += p.vy; p.life -= 0.02;
            if(p.life <= 0) this.particles.splice(i, 1);
        }
    }
}

class EntityController {
    constructor(x, y, w, h) {
        this.x = x; this.y = y; this.w = w; this.h = h;
        this.vx = 0; this.vy = 0;
        this.grounded = false;
        this.coyoteTimer = 0;
        this.jumpBuffer = 0;
        this.state = 'idle';
        this.dead = false;
        this.win = false;
    }
}

class ZenithEngine {
    constructor() {
        this.canvas = document.getElementById('zenith-stage');
        this.ctx = this.canvas.getContext('2d');
        this.width = 0; this.height = 0;
        this.camera = { x: 0, y: 0, zoom: 1 };
        this.currentLvl = 1;
        this.activeSkin = 0;
        this.gameState = 'MENU';
        this.entities = { platforms: [], hazards: [], particles: new ParticleSystem(), decos: [] };
        this.player = new EntityController(200, 300, 56, 56);
        this.keys = {};
        this.frame = 0;

        window.addEventListener('resize', () => this.resize());
        window.addEventListener('keydown', e => this.keys[e.code] = true);
        window.addEventListener('keyup', e => this.keys[e.code] = false);
        this.resize();
        this.initVault();
    }

    resize() {
        this.width = this.canvas.width = window.innerWidth;
        this.height = this.canvas.height = window.innerHeight;
    }

    initVault() {
        const vault = document.getElementById('skinVault');
        vault.innerHTML = '';
        const unlocked = Math.min(5, Math.floor((this.currentLvl - 1) / 5) + 1);
        SKINS.forEach((s, i) => {
            const hex = document.createElement('div');
            hex.className = `skin-hex ${i < unlocked ? 'unlocked' : 'locked'} ${i === this.activeSkin ? 'selected' : ''}`;
            hex.innerHTML = `<div class="hex-inner"><div style="width:60px;height:60px;background:${s.p};border:2px solid ${s.eye};border-radius:10px;box-shadow: 0 0 20px ${s.glow}"></div><div style="font-size:10px;margin-top:10px;letter-spacing:2px">${s.name}</div></div>`;
            if(i < unlocked) hex.onclick = () => { this.activeSkin = i; this.initVault(); };
            vault.appendChild(hex);
        });
    }

    buildWorld(lvl) {
        this.entities.platforms = []; this.entities.hazards = []; this.entities.decos = [];
        this.camera.x = 0; this.player.x = 200; this.player.y = 300; this.player.vx = 0; this.player.vy = 0;
        this.player.dead = false; this.player.win = false;

        const b = BIOMES[Math.floor((lvl-1)/10) % BIOMES.length];
        document.getElementById('lvlDisplay').innerText = lvl.toString().padStart(2, '0');
        document.getElementById('biomeDisplay').innerText = `SECTOR: ${b.name} // UPLINK_ESTABLISHED`;

        // Generate Cinematic Backdrop
        for(let i=0; i<120; i++) {
            this.entities.decos.push({
                x: Math.random() * 12000, y: Math.random() * this.height,
                z: Math.random() * 0.7 + 0.1, s: Math.random() * 4 + 1, o: Math.random()
            });
        }

        let curX = 0, curY = 600;
        this.entities.platforms.push(new Platform(0, 600, 800, 600, 'START', b.p));

        const levelLength = 25 + Math.floor(lvl * 1.5);
        const dangerCoeff = Math.min(0.85, 0.15 + (lvl * 0.03));

        for(let i=0; i < levelLength; i++) {
            let pW = 220 + Math.random() * 280;
            let pX = curX + 180 + Math.random() * 140;
            let pY = curY + (Math.random() * 260 - 130);
            pY = Math.max(250, Math.min(this.height - 220, pY));

            let type = 'NORMAL';
            const rnd = Math.random();
            if(lvl > 5 && rnd > 0.88) type = 'SHIFTING';
            else if(lvl > 10 && rnd > 0.82) type = 'CRYSTAL';
            else if(lvl > 15 && rnd > 0.75) type = 'VOLATILE';
            else if(lvl > 20 && rnd > 0.7) type = 'KINETIC';

            this.entities.platforms.push(new Platform(pX, pY, pW, 55, type, (i%2?b.p:b.sec)));

            // High-End Obstacle Logic
            if(i > 3 && Math.random() < dangerCoeff) {
                let hType = (lvl < 8) ? 'SPIKE_CLUSTER' : (Math.random() > 0.5 ? 'SENTINEL' : 'PLASMA_TURRET');
                if(lvl > 35 && Math.random() > 0.8) hType = 'SINGULARITY_ORB';
                this.entities.hazards.push(new Hazard(pX + 60 + Math.random()*(pW-120), pY - 55, hType));
            }
            curX = pX; curY = pY;
        }

        this.entities.platforms.push(new Platform(curX + 500, curY - 100, 250, 1500, 'ZENITH_GATE', '#00ff88'));
    }

    update() {
        if(this.gameState !== 'PLAY') return;
        this.frame++;

        // --- PLAYER LOGIC (Quantum Physics) ---
        const p = this.player;
        if(this.keys['ArrowLeft'] || this.keys['KeyA']) p.vx -= 1.8;
        if(this.keys['ArrowRight'] || this.keys['KeyD']) p.vx += 1.8;
        p.vx *= CONFIG.FRICTION;
        p.vy += CONFIG.GRAVITY;
        if(p.vy > CONFIG.MAX_FALL_SPEED) p.vy = CONFIG.MAX_FALL_SPEED;

        p.x += p.vx; p.y += p.vy;

        // Camera Lerp
        const targetCam = p.x - this.width / 3.5;
        this.camera.x += (targetCam - this.camera.x) * 0.12;

        // Jump System
        if(p.grounded) p.coyoteTimer = CONFIG.COYOTE_TIME; else p.coyoteTimer--;
        if(this.keys['ArrowUp'] || this.keys['Space'] || this.keys['KeyW']) p.jumpBuffer = CONFIG.JUMP_BUFFER;
        else p.jumpBuffer--;

        if(p.jumpBuffer > 0 && p.coyoteTimer > 0) {
            p.vy = CONFIG.JUMP_IMPULSE;
            p.jumpBuffer = 0; p.coyoteTimer = 0; p.grounded = false;
            this.entities.particles.spawn(p.x + 28, p.y + 56, '#fff', 15);
        }

        // Collision Pipeline
        p.grounded = false;
        this.entities.platforms.forEach(plat => {
            if(plat.type === 'SHIFTING') plat.y = plat.oy + Math.sin(Date.now()/500 + plat.off) * 90;
            
            if(p.x + p.w > plat.x && p.x < plat.x + plat.w && p.y + p.h > plat.y && p.y + p.h < plat.y + plat.h + 28 && p.vy >= 0) {
                if(plat.type === 'ZENITH_GATE') { p.win = true; return; }
                p.y = plat.y - p.h;
                p.vy = (plat.type === 'KINETIC') ? -35 : 0;
                p.grounded = true;
                if(plat.type === 'VOLATILE') plat.health -= 0.02;
            }
        });

        // Hazards Logic
        this.entities.hazards.forEach(h => {
            h.tick();
            let dist = Math.hypot((p.x + 28) - (h.x + 25), (p.y + 28) - (h.y + 25));
            if(dist < 48) p.dead = true;
        });

        if(p.y > this.height + 500) p.dead = true;
        if(p.dead) this.buildWorld(this.currentLvl);
        if(p.win) this.levelTransition();

        this.entities.particles.update();
    }

    levelTransition() {
        this.gameState = 'MENU';
        this.currentLvl++;
        document.getElementById('menu-overlay').style.display = 'flex';
        document.getElementById('menu-overlay').style.opacity = '1';
        this.initVault();
    }

    render() {
        const b = BIOMES[Math.floor((this.currentLvl-1)/10) % BIOMES.length];
        this.ctx.fillStyle = b.sky;
        this.ctx.fillRect(0, 0, this.width, this.height);

        // Backdrop Render (Parallax)
        this.entities.decos.forEach(d => {
            this.ctx.fillStyle = `rgba(255,255,255,${d.o})`;
            let sx = (d.x - this.camera.x * d.z) % (this.width + 1000);
            if(sx < -500) sx += this.width + 1000;
            this.ctx.beginPath();
            this.ctx.arc(sx, d.y, d.s, 0, Math.PI*2);
            this.ctx.fill();
        });

        this.entities.platforms.forEach(p => p.draw(this.ctx, this.camera.x));
        this.entities.hazards.forEach(h => h.draw(this.ctx, this.camera.x));
        
        // Render Particles
        this.entities.particles.particles.forEach(p => {
            this.ctx.fillStyle = p.color;
            this.ctx.globalAlpha = p.life;
            this.ctx.fillRect(p.x - this.camera.x, p.y, p.size, p.size);
        });
        this.ctx.globalAlpha = 1;

        this.renderPlayer();
        this.update();
        requestAnimationFrame(() => this.render());
    }

    renderPlayer() {
        const s = SKINS[this.activeSkin];
        const p = this.player;
        this.ctx.save();
        this.ctx.translate(p.x - this.camera.x + 28, p.y + 28);
        this.ctx.rotate(p.vx * 0.05);

        // Bloom & Body
        this.ctx.shadowBlur = 40; this.ctx.shadowColor = s.glow;
        this.ctx.fillStyle = s.p;
        this.ctx.beginPath();
        this.ctx.roundRect(-28, -28, 56, 56, 18);
        this.ctx.fill();

        // Technical Detail Overlay
        this.ctx.shadowBlur = 0;
        this.ctx.fillStyle = s.s;
        this.ctx.fillRect(-28, -8, 56, 16);
        this.ctx.fillRect(-12, -28, 24, 12);

        // The Cyber Visor
        this.ctx.fillStyle = "#000";
        this.ctx.beginPath();
        this.ctx.roundRect(-28, -16, 56, 26, 8);
        this.ctx.fill();

        // Glowing Eyes
        this.ctx.fillStyle = s.eye;
        this.ctx.shadowBlur = 20; this.ctx.shadowColor = s.eye;
        const eyePulse = Math.sin(Date.now()/200) * 2;
        this.ctx.fillRect(-18, -10, 15, 6 + eyePulse);
        this.ctx.fillRect(4, -10, 15, 6 + eyePulse);

        // Veteran Vanguard Scar
        this.ctx.strokeStyle = "rgba(255,0,0,0.6)";
        this.ctx.lineWidth = 4;
        this.ctx.beginPath(); this.ctx.moveTo(15, -35); this.ctx.lineTo(25, -5); this.ctx.stroke();

        this.ctx.restore();
    }
}

class Platform {
    constructor(x, y, w, h, type, c) {
        Object.assign(this, {x, y, w, h, type, c, oy: y, off: Math.random()*10, health: 1});
    }
    draw(ctx, camX) {
        if(this.health <= 0) return;
        let sx = this.x - camX;
        ctx.save();
        ctx.globalAlpha = this.health;
        const grad = ctx.createLinearGradient(sx, this.y, sx, this.y + this.h);
        grad.addColorStop(0, this.c); grad.addColorStop(1, '#000');
        
        if(this.type === 'ZENITH_GATE') {
            ctx.shadowBlur = 60; ctx.shadowColor = '#00ff88'; ctx.fillStyle = '#00ff88';
        } else if(this.type === 'CRYSTAL') {
            ctx.shadowBlur = 25; ctx.shadowColor = '#00d2d3'; ctx.fillStyle = '#7ed6df';
        } else {
            ctx.fillStyle = grad;
        }

        ctx.beginPath(); ctx.roundRect(sx, this.y, this.w, this.h, 14); ctx.fill();
        ctx.strokeStyle = "rgba(255,255,255,0.1)"; ctx.strokeRect(sx+10, this.y+10, this.w-20, 15);
        ctx.restore();
    }
}

class Hazard {
    constructor(x, y, type) {
        Object.assign(this, {x, y, type, t: 0, vx: 2});
    }
    tick() {
        this.t++;
        if(this.type === 'SENTINEL') {
            this.x += Math.sin(this.t * 0.06) * 6;
        }
    }
    draw(ctx, camX) {
        let sx = this.x - camX;
        ctx.save();
        ctx.shadowBlur = 30; ctx.shadowColor = this.type === 'PLASMA_TURRET' ? 'orange' : 'red';
        
        if(this.type === 'SPIKE_CLUSTER') {
            ctx.fillStyle = '#ff4757'; ctx.beginPath(); 
            for(let i=0; i<3; i++) {
                ctx.moveTo(sx + i*15, this.y+50); ctx.lineTo(sx + 7 + i*15, this.y); ctx.lineTo(sx + 15 + i*15, this.y+50);
            }
            ctx.fill();
        } else if(this.type === 'SENTINEL') {
            ctx.fillStyle = '#fff'; ctx.beginPath(); ctx.arc(sx+25, this.y+25, 22, 0, Math.PI*2); ctx.fill();
            ctx.fillStyle = '#000'; ctx.fillRect(sx+12, this.y+20, 26, 8);
        } else if(this.type === 'PLASMA_TURRET') {
            ctx.fillStyle = '#333'; ctx.fillRect(sx, this.y, 50, 50);
            if(Math.floor(this.t/100)%2 === 0) {
                ctx.fillStyle = '#ffea00'; ctx.beginPath(); ctx.arc(sx-20, this.y+25, 12, 0, Math.PI*2); ctx.fill();
            }
        }
        ctx.restore();
    }
}

// --- INITIALIZATION ---
const Vanguard = new ZenithEngine();

function bootstrap_vanguard() {
    document.getElementById('menu-overlay').style.opacity = '0';
    setTimeout(() => {
        document.getElementById('menu-overlay').style.display = 'none';
        Vanguard.gameState = 'PLAY';
        Vanguard.buildWorld(Vanguard.currentLvl);
        Vanguard.render();
    }, 1000);
}
</script>
</body>
</html>
