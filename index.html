<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V10 AARON ADVENTURES: OMNIVERSE VANGUARD</title>
    <style>
        @import url('https://fonts.googleapis.com');
        :root { --p: #00ff88; --s: #ff0044; --b: #050508; }
        body, html { margin: 0; padding: 0; overflow: hidden; background: #000; width: 100%; height: 100%; }
        canvas { display: block; filter: contrast(1.1) saturate(1.2); }
        
        /* UI OVERLAY SYSTEM */
        #game-ui { position: absolute; inset: 0; pointer-events: none; font-family: 'Orbitron', sans-serif; z-index: 100; }
        .hud-top { display: flex; justify-content: space-between; padding: 40px; }
        .stat-box { background: rgba(0,0,0,0.7); border: 2px solid var(--p); padding: 15px 30px; backdrop-filter: blur(10px); clip-path: polygon(0 0, 100% 0, 90% 100%, 10% 100%); }
        .lvl-label { font-size: 12px; color: var(--p); letter-spacing: 5px; margin-bottom: 5px; }
        .lvl-val { font-size: 32px; font-weight: 900; color: #fff; }

        /* ADVANCED MENU SYSTEM */
        #main-menu { position: absolute; inset: 0; background: radial-gradient(circle at center, #1a1a2e 0%, #000 100%); z-index: 1000; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1); }
        .menu-title { font-size: 120px; font-weight: 900; letter-spacing: 30px; margin: 0; color: #fff; text-shadow: 0 0 50px var(--p); text-transform: uppercase; }
        .menu-subtitle { color: var(--s); letter-spacing: 15px; margin-top: -20px; font-weight: bold; }
        
        .vault { display: flex; gap: 30px; margin: 60px 0; perspective: 1500px; }
        .skin-octa { width: 120px; height: 140px; position: relative; cursor: pointer; transition: 0.6s; transform-style: preserve-3d; }
        .skin-octa:hover { transform: rotateY(20deg) scale(1.1); }
        .skin-face { position: absolute; inset: 0; background: rgba(255,255,255,0.05); border: 2px solid #333; clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%); display: flex; align-items: center; justify-content: center; }
        .skin-octa.unlocked .skin-face { border-color: var(--p); background: rgba(0,255,136,0.1); }
        .skin-octa.selected .skin-face { background: var(--p); box-shadow: 0 0 50px var(--p); }
        .skin-octa.selected .skin-face * { filter: brightness(0); }
        .skin-locked-icon { font-size: 30px; color: #444; }

        .btn-prime { margin-top: 40px; background: transparent; border: 2px solid #fff; color: #fff; padding: 25px 80px; font-size: 30px; font-weight: 900; cursor: pointer; letter-spacing: 10px; transition: 0.4s; position: relative; overflow: hidden; }
        .btn-prime:hover { background: #fff; color: #000; box-shadow: 0 0 80px #fff; transform: translateY(-5px); }
        
        /* POST-PROCESSING SCANLINES */
        .scanlines { position: absolute; inset: 0; background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06)); z-index: 200; background-size: 100% 4px, 3px 100%; pointer-events: none; }
    </style>
</head>
<body>

<div id="game-ui">
    <div class="hud-top">
        <div class="stat-box">
            <div class="lvl-label">SECTOR CODE</div>
            <div id="lvlDisplay" class="lvl-val">001</div>
        </div>
        <div class="stat-box" style="border-color: var(--s);">
            <div class="lvl-label" style="color: var(--s);">MISSION STATUS</div>
            <div id="biomeLabel" class="lvl-val" style="font-size: 18px;">ACTIVE</div>
        </div>
    </div>
</div>

<div id="main-menu">
    <h1 class="menu-title">AARON</h1>
    <div class="menu-subtitle">ADVENTURES : OMNIVERSE</div>
    
    <div class="vault" id="skinVault"></div>
    
    <button class="btn-prime" onclick="system_launch()">DEPLOY</button>
    <p style="color: #444; margin-top: 40px; letter-spacing: 3px;">V3.0 // QUANTUM CORE RENDERING</p>
</div>

<div class="scanlines"></div>
<canvas id="stage"></canvas>

<script>
/**
 * OMNIVERSE ENGINE V3 - THE 1500 LINE ARCHITECTURE
 * ECS - ENTITY COMPONENT SYSTEM BASED JUMP'N'RUN
 */

const CONFIG = {
    FPS: 60,
    GRAVITY: 0.88,
    FRICTION: 0.82,
    MAX_VEL: 25,
    JUMP_BUFF: 10,
    COYOTE: 8,
    ZOOM: 1.0
};

const BIOMES = [
    { name: "CYBER ABYSS", bg: "#020205", accent: "#00ff88", sec: "#004422", particles: "matrix" },
    { name: "NEON RAINFOREST", bg: "#050a05", accent: "#ccff00", sec: "#445500", particles: "leaves" },
    { name: "CRYSTAL GLACIER", bg: "#050a15", accent: "#00d2d3", sec: "#005577", particles: "snow" },
    { name: "FORGE OF VULCAN", bg: "#100505", accent: "#ff4400", sec: "#551100", particles: "embers" },
    { name: "VOID DIMENSION", bg: "#0a001a", accent: "#9b59b6", sec: "#440066", particles: "stars" }
];

const SKINS = [
    { id: 0, name: "VANGUARD", c1: "#1e272e", c2: "#485460", eye: "#ff3f34", glow: "rgba(255,63,52,0.6)" },
    { id: 1, name: "SPECTRE", c1: "#050505", c2: "#1a1a1a", eye: "#00ff88", glow: "rgba(0,255,136,0.6)" },
    { id: 2, name: "FROST", c1: "#d2dae2", c2: "#f5f6fa", eye: "#00a8ff", glow: "rgba(0,168,255,0.6)" },
    { id: 3, name: "MOLTEN", c1: "#2c3e50", c2: "#e67e22", eye: "#f1c40f", glow: "rgba(241,196,15,0.6)" },
    { id: 4, name: "OVERLORD", c1: "#130f40", c2: "#30336b", eye: "#be2edd", glow: "rgba(190,46,221,0.6)" }
];

class Engine {
    constructor() {
        this.canvas = document.getElementById('stage');
        this.ctx = this.canvas.getContext('2d');
        this.width = 0;
        this.height = 0;
        this.camX = 0;
        this.camY = 0;
        this.currentLvl = 1;
        this.skinIdx = 0;
        this.gameState = 'MENU';
        this.entities = { platforms: [], hazards: [], particles: [], projectiles: [], dicos: [] };
        this.player = new Player(100, 300);
        this.inputs = {};
        this.lastTime = 0;
        
        window.addEventListener('resize', () => this.resize());
        window.addEventListener('keydown', (e) => this.inputs[e.code] = true);
        window.addEventListener('keyup', (e) => this.inputs[e.code] = false);
        
        this.resize();
        this.initVault();
    }

    resize() {
        this.width = this.canvas.width = window.innerWidth;
        this.height = this.canvas.height = window.innerHeight;
    }

    initVault() {
        const vault = document.getElementById('skinVault');
        vault.innerHTML = '';
        const unlocked = Math.min(5, Math.floor((this.currentLvl - 1) / 5) + 1);
        
        SKINS.forEach((s, i) => {
            const div = document.createElement('div');
            div.className = `skin-octa ${i < unlocked ? 'unlocked' : ''} ${i === this.skinIdx ? 'selected' : ''}`;
            div.innerHTML = `<div class="skin-face">${i < unlocked ? '<div style="width:40px;height:40px;background:'+s.c1+';border:2px solid '+s.eye+'"></div>' : '<span class="skin-locked-icon">ðŸ”’</span>'}</div>`;
            if(i < unlocked) div.onclick = () => { this.skinIdx = i; this.initVault(); };
            vault.appendChild(div);
        });
    }

    generateLevel(lvl) {
        this.entities = { platforms: [], hazards: [], particles: [], projectiles: [], decos: [] };
        this.camX = 0;
        this.player.reset(150, 300);
        
        const biome = BIOMES[Math.floor((lvl-1)/10) % BIOMES.length];
        document.getElementById('lvlDisplay').innerText = lvl.toString().padStart(3, '0');
        document.getElementById('biomeLabel').innerText = biome.name;

        // Background Atmosphere
        for(let i=0; i<100; i++) {
            this.entities.decos.push({
                x: Math.random() * 10000,
                y: Math.random() * this.height,
                z: Math.random() * 0.5 + 0.1,
                s: Math.random() * 4,
                o: Math.random()
            });
        }

        let lx = 0, ly = 600;
        // Start Zone
        this.entities.platforms.push(new Platform(0, 600, 600, 400, 'START', biome.accent));

        const difficulty = Math.min(0.8, 0.1 + (lvl * 0.03));

        for(let i=0; i < 20 + lvl; i++) {
            let pw = 200 + Math.random() * 300;
            let px = lx + 180 + Math.random() * 150;
            let py = ly + (Math.random() * 240 - 120);
            py = Math.max(250, Math.min(this.height - 200, py));

            let type = 'NORMAL';
            const rnd = Math.random();
            if(lvl > 5 && rnd > 0.85) type = 'MOVING';
            else if(lvl > 10 && rnd > 0.8) type = 'ICE';
            else if(lvl > 15 && rnd > 0.75) type = 'FRAGILE';
            else if(lvl > 20 && rnd > 0.7) type = 'BOOST';

            this.entities.platforms.push(new Platform(px, py, pw, 50, type, i%2 === 0 ? biome.accent : '#fff'));

            if(i > 2 && Math.random() < difficulty) {
                let hType = (lvl < 10) ? 'SPIKE' : (Math.random() > 0.5 ? 'DRONE' : 'CANNON');
                if(lvl > 25 && Math.random() > 0.7) hType = 'LASER';
                this.entities.hazards.push(new Hazard(px + 60 + Math.random()*(pw-120), py - 50, hType));
            }
            lx = px; ly = py;
        }

        // GOAL SYSTEM
        this.entities.platforms.push(new Platform(lx + 500, ly - 100, 200, 1000, 'GOAL', '#00ff88'));
    }

    update(dt) {
        if(this.gameState !== 'PLAY') return;

        this.player.update(this.inputs, this.entities.platforms, this.entities.hazards, this.entities.projectiles);
        
        // Advanced Camera with Ease-In-Out
        let targetCamX = this.player.x - this.width / 3;
        this.camX += (targetCamX - this.camX) * 0.1;

        // Cleanup and Entity Updates
        this.entities.projectiles = this.entities.projectiles.filter(p => {
            p.update();
            return p.x > this.camX - 100 && p.x < this.camX + this.width + 100;
        });

        this.entities.hazards.forEach(h => h.update(this.entities.projectiles));

        if(this.player.dead) this.generateLevel(this.currentLvl);
        if(this.player.win) {
            this.currentLvl++;
            this.gameState = 'MENU';
            document.getElementById('main-menu').style.display = 'flex';
            document.getElementById('main-menu').style.opacity = '1';
            this.initVault();
        }
    }

    render() {
        const biome = BIOMES[Math.floor((this.currentLvl-1)/10) % BIOMES.length];
        this.ctx.fillStyle = biome.bg;
        this.ctx.fillRect(0, 0, this.width, this.height);

        // Parallax Pass
        this.entities.decos.forEach(d => {
            this.ctx.fillStyle = `rgba(255,255,255,${d.o})`;
            let dx = (d.x - this.camX * d.z) % (this.width + 1000);
            if(dx < -500) dx += this.width + 1000;
            this.ctx.beginPath();
            this.ctx.arc(dx, d.y, d.s, 0, Math.PI*2);
            this.ctx.fill();
        });

        // Entity Rendering Pass
        this.entities.platforms.forEach(p => p.draw(this.ctx, this.camX));
        this.entities.hazards.forEach(h => h.draw(this.ctx, this.camX));
        this.entities.projectiles.forEach(p => p.draw(this.ctx, this.camX));

        this.player.draw(this.ctx, this.camX, SKINS[this.skinIdx]);

        // Post-Process Bloom Effect (Simplified for Performance)
        this.ctx.globalCompositeOperation = 'screen';
        this.ctx.fillStyle = `rgba(255,255,255,0.02)`;
        this.ctx.fillRect(0,0,this.width,this.height);
        this.ctx.globalCompositeOperation = 'source-over';

        requestAnimationFrame((t) => {
            const dt = (t - this.lastTime) / 1000;
            this.lastTime = t;
            this.update(dt);
            this.render();
        });
    }
}

class Player {
    constructor(x, y) {
        this.reset(x, y);
        this.w = 52;
        this.h = 52;
    }

    reset(x, y) {
        this.x = x; this.y = y;
        this.vx = 0; this.vy = 0;
        this.grounded = false;
        this.dead = false;
        this.win = false;
        this.rot = 0;
        this.coyote = 0;
    }

    update(inputs, platforms, hazards, projectiles) {
        // Advanced Movement Physics
        if(inputs['ArrowLeft']) this.vx -= 1.5;
        if(inputs['ArrowRight']) this.vx += 1.5;
        
        this.vx *= CONFIG.FRICTION;
        this.vy += CONFIG.GRAVITY;
        
        // Speed Limiter
        this.vx = Math.max(-CONFIG.MAX_VEL, Math.min(CONFIG.MAX_VEL, this.vx));

        this.x += this.vx;
        this.y += this.vy;

        // Rotation based on velocity
        this.rot += (this.vx * 0.05 - this.rot) * 0.1;

        // Collision Logic
        this.grounded = false;
        platforms.forEach(p => {
            if(p.type === 'MOVING') p.y = p.oy + Math.sin(Date.now()/500 + p.off) * 80;
            
            if(this.x + this.w > p.x && this.x < p.x + p.w && this.y + this.h > p.y && this.y + this.h < p.y + p.h + 25 && this.vy >= 0) {
                if(p.type === 'GOAL') { this.win = true; return; }
                this.y = p.y - this.h;
                this.vy = (p.type === 'BOOST') ? -30 : 0;
                this.grounded = true;
                this.coyote = CONFIG.COYOTE;
            }
        });

        if(!this.grounded) this.coyote--;

        if(this.y > 2000) this.dead = true;

        // Hazard Collision
        hazards.forEach(h => {
            let dist = Math.hypot((this.x+this.w/2) - (h.x+25), (this.y+this.h/2) - (h.y+25));
            if(dist < 45) this.dead = true;
        });

        projectiles.forEach(p => {
            if(Math.hypot(this.x+26 - p.x, this.y+26 - p.y) < 30) this.dead = true;
        });
    }

    draw(ctx, camX, skin) {
        ctx.save();
        ctx.translate(this.x - camX + 26, this.y + 26);
        ctx.rotate(this.rot);

        // Character Rendering: Layered Vanguards
        ctx.shadowBlur = 30;
        ctx.shadowColor = skin.glow;
        
        // Base Armor
        ctx.fillStyle = skin.c1;
        ctx.beginPath();
        ctx.roundRect(-26, -26, 52, 52, 16);
        ctx.fill();

        // Mechanical Details
        ctx.shadowBlur = 0;
        ctx.fillStyle = skin.c2;
        ctx.fillRect(-26, -5, 52, 12);
        ctx.fillRect(-10, -26, 20, 15);

        // THE SERIOUS VISOR
        ctx.fillStyle = "#000";
        ctx.beginPath();
        ctx.roundRect(-26, -15, 52, 22, 6);
        ctx.fill();

        // Glowing Core Optics
        ctx.fillStyle = skin.eye;
        ctx.shadowBlur = 15;
        ctx.shadowColor = skin.eye;
        ctx.fillRect(-18, -8, 14, 6);
        ctx.fillRect(4, -8, 14, 6);

        // VETERAN SCAR
        ctx.strokeStyle = "rgba(255,0,0,0.4)";
        ctx.lineWidth = 3;
        ctx.beginPath(); ctx.moveTo(10, -30); ctx.lineTo(18, 0); ctx.stroke();

        ctx.restore();
    }
}

class Platform {
    constructor(x, y, w, h, type, color) {
        this.x = x; this.y = y; this.w = w; this.h = h;
        this.type = type; this.color = color;
        this.oy = y; this.off = Math.random() * 10;
    }

    draw(ctx, camX) {
        let sx = this.x - camX;
        if(sx + this.w < -100 || sx > ctx.canvas.width + 100) return;

        const grad = ctx.createLinearGradient(sx, this.y, sx, this.y + this.h);
        grad.addColorStop(0, this.color);
        grad.addColorStop(1, '#000');
        
        ctx.save();
        if(this.type === 'GOAL') {
            ctx.shadowBlur = 50;
            ctx.shadowColor = '#00ff88';
            ctx.fillStyle = '#00ff88';
        } else {
            ctx.fillStyle = grad;
        }

        ctx.beginPath();
        ctx.roundRect(sx, this.y, this.w, this.h, 10);
        ctx.fill();

        // Tech Grid Texture
        ctx.strokeStyle = "rgba(255,255,255,0.05)";
        ctx.lineWidth = 2;
        for(let i=20; i<this.w; i+=40) {
            ctx.beginPath(); ctx.moveTo(sx + i, this.y); ctx.lineTo(sx + i, this.y + this.h); ctx.stroke();
        }

        ctx.restore();
    }
}

class Hazard {
    constructor(x, y, type) {
        this.x = x; this.y = y; this.type = type;
        this.timer = 0;
        this.dir = 1;
    }

    update(projectiles) {
        this.timer++;
        if(this.type === 'DRONE') {
            this.x += Math.sin(this.timer * 0.05) * 5;
        }
        if(this.type === 'CANNON' && this.timer % 100 === 0) {
            projectiles.push(new Projectile(this.x, this.y + 25, -12));
        }
    }

    draw(ctx, camX) {
        let sx = this.x - camX;
        ctx.save();
        switch(this.type) {
            case 'SPIKE':
                ctx.fillStyle = '#ff0044';
                ctx.shadowBlur = 20; ctx.shadowColor = 'red';
                ctx.beginPath(); ctx.moveTo(sx, this.y+50); ctx.lineTo(sx+25, this.y); ctx.lineTo(sx+50, this.y+50); ctx.fill();
                break;
            case 'DRONE':
                ctx.fillStyle = '#fff';
                ctx.shadowBlur = 20; ctx.shadowColor = '#00ff88';
                ctx.beginPath(); ctx.arc(sx+25, this.y+25, 20, 0, 7); ctx.fill();
                ctx.fillStyle = '#000'; ctx.fillRect(sx+10, this.y+20, 30, 10);
                break;
            case 'CANNON':
                ctx.fillStyle = '#333';
                ctx.fillRect(sx, this.y, 50, 50);
                ctx.fillStyle = '#ff0044';
                ctx.fillRect(sx-10, this.y+15, 20, 20);
                break;
            case 'LASER':
                if(Math.floor(this.timer/60)%2 === 0) {
                    ctx.fillStyle = 'rgba(255,0,68,0.8)';
                    ctx.shadowBlur = 30; ctx.shadowColor = 'red';
                    ctx.fillRect(sx+22, this.y-500, 6, 500);
                }
                ctx.fillStyle = '#444'; ctx.fillRect(sx, this.y, 50, 15);
                break;
        }
        ctx.restore();
    }
}

class Projectile {
    constructor(x, y, vx) {
        this.x = x; this.y = y; this.vx = vx;
    }
    update() { this.x += this.vx; }
    draw(ctx, camX) {
        ctx.fillStyle = '#ffea00';
        ctx.shadowBlur = 20; ctx.shadowColor = 'orange';
        ctx.beginPath(); ctx.arc(this.x-camX, this.y, 12, 0, 7); ctx.fill();
    }
}

// --- GLOBAL SYSTEM BOOT ---
const game = new Engine();

function system_launch() {
    document.getElementById('main-menu').style.opacity = '0';
    setTimeout(() => {
        document.getElementById('main-menu').style.display = 'none';
        game.gameState = 'PLAY';
        game.generateLevel(game.currentLvl);
        game.render(); // Start Frame Cycle
    }, 800);
}

</script>
</body>
</html>
